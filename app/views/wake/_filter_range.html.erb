<% 
	choices = filter_range 
	raise 'ARRAY EXPECTED' unless choices.is_a? Array
%>


<%= form_tag({:action=>'index'}, :method=>:get, :class=>'inline') do %>

  <%= select 'filter_range', 'key', choices, {:selected=>(params[:filter_range]||{})[:key] } %> : 

	<%= text_field_tag 'filter_range[from]', (params[:filter_range]||{})[:from], 
	  :size=>9, :class=>((params[:filter_range]||{})[:from_error] ? 'field_with_errors' : '') %>
	
	&rarr;
	
	<%= text_field_tag 'filter_range[until]', (params[:filter_range]||{})[:until], 
	  :size=>9, :class=>((params[:filter_range]||{})[:until_error] ? 'field_with_errors' : '') %>
	
	<%= submit_tag 'Filter!' %>
	
	
	<% for k,v in (params[:filter]||{}) %>
	  <input type="hidden" name="filter[<%=k%>]" value="<%=v%>">
	<% end %>
	<% if params[:search] %>
		<input type="hidden" name="search" value="<%= params[:search] %>">
	<% end %>
	
<% end %>